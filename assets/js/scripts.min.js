"use strict";jQuery(document).foundation();var options={anchors:"a.smoothstate",prefetch:!0,cacheLength:2,onStart:{duration:500,render:function(e){e.addClass("is-exiting"),Foundation.Motion.animateOut(jQuery("#post"),"fade-out"),smoothState.restartCSSAnimations()}},onReady:{duration:0,render:function(e,t){e.removeClass("is-exiting"),e.html(t),Foundation.Motion.animateIn(jQuery("#post"),"fade-in"),jQuery("#site-body").addClass("content-visible"),map.invalidateSize()}}},smoothState=jQuery("#content").smoothState(options).data("smoothState");if(jQuery("#map").length){var addingPlace=function(e){1==e?(jQuery("#add-place").addClass("hide"),jQuery("#centerpoint").addClass("newpin")):(jQuery("#add-place").removeClass("hide"),jQuery("#centerpoint").removeClass("newpin"))},map=L.map("map",{scrollWheelZoom:!1}).setView(shareabouts.mapDefaultCenter,shareabouts.mapDefaultZoom);L.tileLayer("http://tile-c.openstreetmap.fr/hot/{z}/{x}/{y}.png",{minZoom:4,maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(map);var popup=L.popup(),selected,markerStyle={color:"#1779ba",weight:4,radius:8,fillColor:"#1779ba",fillOpacity:.5},selectedMarkerStyle={color:"#dd0000",weight:5,radius:10,fillColor:"#eeeeee",fillOpacity:1};jQuery.ajax({url:shareabouts.jsonurl,dataType:"json",success:function(e){function t(e,t){var o=e.properties.permalink;t.on("click",function(e){smoothState.load(o),selected&&a.resetStyle(selected),selected=e.target,selected.bringToFront(),selected.setStyle(selectedMarkerStyle),addingPlace(!1)}),o==window.location&&(t.setStyle(selectedMarkerStyle),selected=t)}var a=L.geoJson(e,{style:function(){return markerStyle},pointToLayer:function(e,t){return new L.CircleMarker(t)},onEachFeature:t});map.addLayer(a)}}),jQuery(document).on("click","#content-close-button",function(e){selected&&selected.setStyle(markerStyle),jQuery("#site-body").removeClass("content-visible"),map.invalidateSize(),addingPlace(!1)}),jQuery(document).on("click","#add-place",function(e){e.preventDefault(),selected&&selected.setStyle(markerStyle);var t=jQuery(this).attr("href");smoothState.load(t),addingPlace(!0),Foundation.Motion.animateIn(jQuery("#centerpoint"),"fade-in")}),map.on("movestart",function(e){jQuery("#centerpoint").addClass("dragging")}),map.on("moveend",function(e){jQuery("#centerpoint").removeClass("dragging");var t=map.getCenter();t=t.lat+", "+t.lng,jQuery("#place-submission-location").val(t)})}